# 接口合并文档

> 项目适配说明（2026-02-04）
> - 本项目实际使用的系统能力：`system.router`、`system.audio`、`system.fetch`、`system.request`、`system.file`、`system.crypto`、`system.vibrator`、`system.prompt`、`system.device`、`system.app`、`system.interconnect`。
> - `system.brightness` 仅在 manifest 中声明，当前代码未使用。
> - 具体调用点可在 `src/common` 与 `src/pages` 中检索（如 `download.js`、`lisync.js`、`license.js`、`player.ux`）。
此文档合并了 C:/Users/lxslx/Desktop/docs/usable\接口 目录下的所有MD文件。

## 上传_uploadtask.md

## 上传 uploadtask3+

## 接口声明

## 导入模块

## 接口定义

##### 方法

##### UploadTask uploadtask.uploadFile(OBJECT)

创建一个上传请求，每次成功调用 uploadtask.uploadFile 将返回本次请求的 UploadTask 实例

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| url | String | 是 | 开发者服务器接口地址 |
| filePath | String | 是 | 要上传文件资源的路径 (本地路径) |
| name | String | 是 | 文件对应的 key，开发者在服务端可以通过这个 key 获取文件的二进制内容 |
| header | Object | 否 | 请求的 header，会将其所有属性设置到请求的 header 部分 |
| formData | Object | 否 | HTTP 请求中其他额外的 form data |
| timeout | Number | 否 | 超时时间，单位为毫秒 |
| success | Function | 否 | 成功返回的回调函数 |
| fail | Function | 否 | 失败的回调函数 |
| complete | Function | 否 | 结束的回调函数（调用成功、失败都会执行） |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| statusCode | Integer | 服务器状态 code |
| data | String | 开发者服务器返回的数据 |
| headers | Object | 服务器 response 的所有 header |

## 方法

##### UploadTask.abort()

中断上传任务

##### UploadTask.onProgressUpdate(callback)

监听上传进度变化事件

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| callback | Function | 是 | 上传进度变化事件的回调函数 |

###### callback 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| progress | Number | 上传进度百分比 |
| totalBytesSent | Number | 已经上传的数据长度，单位 Bytes |
| totalBytesExpectedToSend | Number | 预期需要上传的数据总长度，单位 Bytes |

##### UploadTask.offProgressUpdate(function callback)

取消监听上传进度变化事件。callback 是可选的，如果不传则取消所有通过 onProgressUpdate 监听的上传进度变化事件

###### 示例：

取消特定的上传进度事件

## 支持明细

| 设备产品 | 说明 |
| --- | --- |
| 小米 S1 Pro 运动健康手表 | 不支持 |
| 小米手环 8 Pro | 不支持 |
| 小米手环 9 / 9 Pro | 不支持 |
| Xiaomi Watch S3 | 支持 |
| Redmi Watch 4 | 不支持 |
| 小米腕部心电血压记录仪 | 不支持 |
| 小米手环 10 | 不支持 |
| Xiaomi Watch S4 | 支持 |
| REDMI Watch 5 | 支持 |


---

## 下载_request.md

## 接口声明

## 导入模块

## 接口定义

##### request.download(OBJECT)

下载文件

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| url | String | 是 | 资源 url |
| header | String | 否 | 请求的 header，会将其所有属性设置到请求的 header 部分 |
| filename | String | 否 | 下载文件名。默认从网络请求或 url 中获取 |
| success | Function | 否 | 成功返回的回调函数 |
| fail | Function | 否 | 失败的回调函数 |
| complete | Function | 否 | 结束的回调函数（调用成功、失败都会执行） |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| token | String | 下载的 token，根据此 token 获取下载状态 |

###### 示例：

##### request.onDownloadComplete(OBJECT)

监听下载任务

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| token | String | 是 | download 接口返回的 token |
| success | Function | 否 | 成功返回的回调函数 |
| fail | Function | 否 | 失败的回调函数 |
| complete | Function | 否 | 结束的回调函数（调用成功、失败都会执行） |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| uri | String | 下载文件的 Uri（默认情况下该文件处于应用缓存目录。如果文件类型为图片或者视频且要求用户可以在相册等应用内查看，则需要将该文件转存至公共目录，参考media接口中的方法实现即可） |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 1000 | 下载失败 |
| 1001 | 下载任务不存在 |

###### 示例：

## 支持明细

| 设备产品 | 说明 |
| --- | --- |
| 小米 S1 Pro 运动健康手表 | 支持 |
| 小米手环 8 Pro | 不支持 |
| 小米手环 9 / 9 Pro | 不支持 |
| Xiaomi Watch S3 | 支持 |
| Redmi Watch 4 | 不支持 |
| 小米腕部心电血压记录仪 | 不支持 |
| 小米手环 10 | 不支持 |
| Xiaomi Watch S4 | 支持 |
| REDMI Watch 5 | 支持 |


---

## 事件_event.md

## 事件 event4+

## 接口声明

## 导入模块

## 接口定义

##### event.publish (OBJECT)

发布公共事件

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| eventName | String | 是 | 事件名称，公共事件保留名称被系统占用，请勿使用 |
| options | Object | 否 | 事件参数 |

###### options 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| params | Object | 否 | 事件参数 |
| permissions | Array<String> | 否 | 订阅者的权限，拥有权限的包才能收到发送的事件 |

###### 系统支持的公共事件：

| 系统内部事件名称 | 订阅者所需权限 | 说明 |
| --- | --- | --- |
| usual.event.BATTERY_CHANGED | 无 | 电量改变，参数：level:0.0 - 1.0 之间 |
| usual.event.DISCHARGING | 无 | 停止充电 |
| usual.event.CHARGING | 无 | 开始充电 |

###### 返回值：

无

###### 示例：

##### event.subscribe(OBJECT)

订阅公共事件

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| eventName | String | 是 | 事件名称 |
| callback | Function | 是 | 回调函数 |

###### 回调参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| params | Object | 否 | 事件参数 |
| package | String | 否 | 事件推送者包名 |

###### 返回值：

| 类型 | 必填 | 说明 |
| --- | --- | --- |
| Number | 是 | 事件id，订阅失败返回undefined |

###### 示例：

##### event.unsubscribe(OBJECT)

取消订阅公共事件

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| id | Number | 是 | 订阅id |

###### 示例：

## 支持明细

| 设备产品 | 说明 |
| --- | --- |
| 小米 S1 Pro 运动健康手表 | 不支持 |
| 小米手环 8 Pro | 不支持 |
| 小米手环 9 / 9 Pro | 不支持 |
| Xiaomi Watch S3 | 不支持 |
| Redmi Watch 4 | 不支持 |
| 小米腕部心电血压记录仪 | 不支持 |
| 小米手环 10 | 支持 |
| Xiaomi Watch S4 | 支持 |
| REDMI Watch 5 | 支持 |


---

## 传感器_sensor.md

## 接口声明

## 导入模块

## 接口定义

##### 方法

##### sensor.subscribePressure(OBJECT)

监听压力、压强感应数据。如果多次调用，仅最后一次调用生效

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| callback | Function | 是 | 每次位置信息发生变化，都会被回调 |

###### callback 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| pressure | Number | 压力、压强，单位hpa，百帕，浮点数 |

###### 示例：

##### sensor.unsubscribePressure()

取消压力、压强感应数据

###### 参数：

无

###### 示例：

##### sensor.subscribeAccelerometer(OBJECT)

监听加速度感应数据

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| interval | String | 否 | 监听加速度数据回调函数的执行频率，默认normal |
| callback | Function | 是 | 重力感应数据变化后会回调此函数 |
| fail | Function | 否 | 订阅错误回调 |

###### interval 的合法值：

| 值 | 说明 |
| --- | --- |
| game | 适用于更新游戏的回调频率，在 20ms/次 左右 |
| ui | 适用于更新 UI 的回调频率，在 60ms/次 左右 |
| normal | 普通的回调频率，在 200ms/次 左右 |

###### callback 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| x | Number | x 轴坐标 |
| y | Number | y 轴坐标 |
| z | Number | z 轴坐标 |

###### 示例：

##### sensor.unsubscribeAccelerometer()

取消监听加速度感应数据

###### 参数：

无

###### 示例：

##### sensor.subscribeCompass(OBJECT)

监听罗盘数据。如果多次调用，仅最后一次调用生效

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| callback | Function | 是 | 罗盘数据变化后会回调此函数 |
| fail | Function | 否 | 订阅失败回调 |

###### callback 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| direction | Number | 表示设备的 y 轴和地球磁场北极之间的角度，当面朝北，角度为 0；朝南角度为 π；朝东角度 π/2；朝西角度-π/2 |
| accuracy | Number | 精度，详见compass精度说明 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 1000 | 当前设备不支持罗盘传感器 |

###### 示例：

##### sensor.unsubscribeCompass()

取消监听加速度感应数据

###### 参数：

无

###### 示例：

##### compass精度说明：

| 值 | 说明 |
| --- | --- |
| 3 | 高精度 |
| 2 | 中等精度 |
| 1 | 低精度 |
| -1 | 不可信，传感器失去连接 |
| 0 | 不可信，原因未知 |

## 支持明细

| 接口 | 已支持设备产品 | 不支持设备产品 |
| --- | --- | --- |
| subscribePressure | Xiaomi Watch S3、小米手环 9 Pro、小米手环 10、Xiaomi Watch S4 | 小米 S1 Pro 运动健康手表、小米手环 8 Pro、小米手环 9、Redmi Watch 4、Xiaomi Watch H1、REDMI Watch 5 |
| unsubscribePressure | Xiaomi Watch S3、小米手环 9 Pro、小米手环 10、Xiaomi Watch S4 | 小米 S1 Pro 运动健康手表、小米手环 8 Pro、小米手环 9、Redmi Watch 4、Xiaomi Watch H1、REDMI Watch 5 |
| subscribeAccelerometer | 小米手环 9 / 9 Pro、小米手环 10 | Xiaomi Watch S3、小米 S1 Pro 运动健康手表、小米手环 8 Pro、Redmi Watch 4、Xiaomi Watch H1、Xiaomi Watch S4、REDMI Watch 5 |
| unsubscribeAccelerometer | 小米手环 9 / 9 Pro、小米手环 10 | Xiaomi Watch S3、小米 S1 Pro 运动健康手表、小米手环 8 Pro、Redmi Watch 4、Xiaomi Watch H1、Xiaomi Watch S4、REDMI Watch 5 |
| subscribeCompass / unsubscribeCompass | Xiaomi Watch S4、REDMI Watch 5 | 其余小米环表设备 |


---

## 地理位置_geolocation.md

## 接口声明

## 导入模块

## 接口定义

##### geolocation.getLocation(OBJECT)

获取地理位置

###### 权限要求

精确设备定位

开发者需要在 manifest.json 里面配置权限：

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| timeout | Number | 否 | 设置超时时间，单位是 ms，默认值为 30000 |
| success | Function | 是 | 成功回调 |
| fail | Function | 否 | 失败回调，可能是因为缺乏权限 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| longitude | Number | 经度，浮点数 |
| latitude | Number | 纬度，浮点数 |
| altitude | Number | 海拔、高度，单位m，浮点数 |
| speed | Number | 速度值，单位m/s，浮点数 |
| accuracy | Number | 精确度，值为正整数 |
| accuracyInfo | { horizontal: Number, vertical: Number } | 精确度信息，包含水平和垂直方向精准度 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 203 | 该功能不支持 |
| 204 | 超时返回 |

###### 示例：

##### geolocation.subscribe(OBJECT)

监听地理位置。如果多次调用，仅最后一次调用生效

###### 权限要求

精确设备定位

开发者需要在 manifest.json 里面配置权限：

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| callback | Function | 是 | 每次位置信息发生变化，都会被回调 |
| fail | Function | 否 | 失败回调 |

###### callback 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| longitude | Number | 经度，浮点数 |
| latitude | Number | 纬度，浮点数 |
| altitude | Number | 海拔、高度，单位m，浮点数 |
| speed | Number | 速度值，单位m/s，浮点数 |
| accuracy | Number | 精确度，值为正整数 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 203 | 该功能不支持 |

###### 示例：

##### geolocation.unsubscribe()

取消监听地理位置

###### 权限要求

精确设备定位

开发者需要在 manifest.json 里面配置权限：

###### 参数：

无

###### 示例：

## 支持明细

| 设备产品 | 说明 |
| --- | --- |
| 小米 S1 Pro 运动健康手表 | 不支持 |
| 小米手环 8 Pro | 不支持 |
| 小米手环 9 / 9 Pro | 不支持 |
| Xiaomi Watch S3 | 支持 |
| Redmi Watch 4 | 不支持 |
| 小米腕部心电血压记录仪 | 不支持 |
| 小米手环 10 | 不支持 |
| Xiaomi Watch S4 | 支持 |
| REDMI Watch 5 | 支持 |


---

## 密码算法_crypto.md

## 接口声明

## 导入模块

## 接口定义

##### crypto.hashDigest(OBJECT)

创建数据的哈希摘要

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| data | String/Uint8Array | 否 | 待计算内容，和uri二者必须有一个 |
| uri | String | 否 | 待计算文件地址，和data二者必须有一个 |
| algo | String | 否 | 算法 默认： SHA256 可选：MD5， SHA1，SHA256，SHA512 |

###### 返回值：

| 类型 | 说明 |
| --- | --- |
| String | 经过计算生成的摘要内容 |

###### 示例：

##### crypto.hmacDigest(OBJECT)

创建加密 HMAC 摘要

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| data | String | 是 | 待计算数据 |
| algo | String | 否 | 算法 默认： SHA256 可选：MD5， SHA1，SHA256，SHA512 |
| key | String | 是 | 密钥 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 完成回调 |

###### success 返回值 Object：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| data | String | 摘要 |

###### 示例：

##### crypto.sign(OBJECT)

用于生成签名

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| data | String/Uint8Array | 否 | 被签名文本，和uri二者必须有一个 |
| uri | String | 否 | 被签名文件地址，和data二者必须有一个 |
| algo | String | 否 | 签名算法，默认：'RSA-SHA256' 可选：RSA-MD5， RSA-SHA1，RSA-SHA256，RSA-SHA512 |
| privateKey | String | 是 | 私钥 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 完成回调 |

###### success 返回值 Object：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| data | String/Uint8Array | 如果输入为字符串，则返回经过base64编码的字符串；否则返回Uint8Array；如果只传uri，默认返回string |

###### 示例：

##### crypto.verify(OBJECT)

用于验证签名

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| data | String/Uint8Array | 否 | 被签名文本，和uri二者必须有一个 |
| uri | String | 否 | 被签名文件地址，和data二者必须有一个 |
| algo | String | 否 | 签名算法，默认：'RSA-SHA256' 可选：RSA-MD5， RSA-SHA1，RSA-SHA256，RSA-SHA512 |
| signature | String/Uint8Array | 是 | 签名 |
| publicKey | String | 是 | 公钥 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 完成回调 |

###### success 返回值 Boolean：

| 类型 | 说明 |
| --- | --- |
| Boolean | 校验结果，通过为true，不通过为false |

###### 示例：

##### crypto.encrypt(OBJECT)

加密

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| data | String/Uint8Array | 是 | 待加密数据 |
| algo | String | 否 | 加密算法 默认： RSA 可选：RSA， AES |
| key | String | 是 | 加密使用到的密钥，经过 base64 编码后生成的字符串 |
| options | Object | 否 | 加密参数 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 完成回调 |

###### RSA 参数options：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| transformation | String | 否 | RSA 算法的加密模式和填充项，默认为"RSA/None/PKCS1Padding" |

###### AES 参数options：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| transformation | String | 否 | AES 算法的加密模式和填充项，默认为"AES/CBC/PKCS7Padding" |
| iv | String | 否 | AES 加解密的初始向量，经过 base64 编码后的字符串，默认值为 key 值 |
| ivOffset | Number | 否 | AES 加解密的初始向量偏移，整数，默认值为 0 |
| ivLen | Number | 否 | AES 加解密的初始向量字节长度，整数，默认值为 16 |

###### success 返回值 Object：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| data | String/Uint8Array | 如果输入为字符串，则返回经过base64编码的字符串；否则返回Uint8Array |

###### 示例：

##### crypto.decrypt(OBJECT)

解密

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| data | String/Uint8Array | 是 | 待解密数据 |
| algo | String | 否 | 解密算法 默认： RSA 可选：RSA， AES |
| key | String | 是 | 加密或解密使用到的密钥，经过 base64 编码后生成的字符串 |
| options | Object | 否 | 解密参数 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 完成回调 |

###### RSA 参数options：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| transformation | String | 否 | RSA 算法的加密模式和填充项，默认为"RSA/None/PKCS1Padding" |

###### AES 参数options：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| transformation | String | 否 | AES 算法的加密模式和填充项，默认为"AES/CBC/PKCS7Padding" |
| iv | String | 否 | AES 加解密的初始向量，经过 base64 编码后的字符串，默认值为 key 值 |
| ivOffset | Number | 否 | AES 加解密的初始向量偏移，整数，默认值为 0 |
| ivLen | Number | 否 | AES 加解密的初始向量字节长度，整数，默认值为 16 |

###### success 返回值 Object：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| data | String/Uint8Array | 如果输入为字符串，则返回经过base64编码的字符串；否则返回Uint8Array |

###### 示例：

##### crypto.btoa(STRING)

从String对象中创建一个 base-64 编码的 ASCII 字符串，其中字符串中的每个字符都被视为一个二进制数据字节

###### 参数：

| 类型 | 必填 | 说明 |
| --- | --- | --- |
| String | 是 | 待编码文本 |

###### 返回值 String：

| 类型 | 说明 |
| --- | --- |
| String | 经过编码之后的结果 |

###### 示例：

##### crypto.atob(STRING)

对经过 base-64 编码的字符串进行解码

###### 参数：

| 类型 | 必填 | 说明 |
| --- | --- | --- |
| String | 是 | 待解码文本 |

###### 返回值 String：

| 类型 | 说明 |
| --- | --- |
| String | 经过解码之后的结果 |

###### 示例：

## 支持明细

| 设备产品 | 说明 |
| --- | --- |
| 小米 S1 Pro 运动健康手表 | 不支持 |
| 小米手环 8 Pro | 不支持 |
| 小米手环 9 / 9 Pro | 不支持 |
| Xiaomi Watch S3 | 支持 |
| Redmi Watch 4 | 不支持 |
| 小米腕部心电血压记录仪 | 不支持 |
| 小米手环 10 | 不支持 |
| Xiaomi Watch S4 | 支持 |
| REDMI Watch 5 | 支持 |


---

## 屏幕亮度_brightness.md

## 接口声明

## 导入模块

## 接口定义

##### brightness.getValue(OBJECT)

获得当前屏幕亮度值

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| value | Integer | 屏幕亮度，取值范围 0-255 |

###### 示例：

##### brightness.setValue(OBJECT)

设置当前屏幕亮度值

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| value | Integer | 是 | 屏幕亮度，取值范围 0-255 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### 示例：

##### brightness.getMode(OBJECT)

获得当前屏幕亮度模式

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| mode | Integer | 0 为手动调节屏幕亮度，1 为自动调节屏幕亮度 |

###### 示例：

##### brightness.setMode(OBJECT)

设置当前屏幕亮度模式

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| mode | Integer | 是 | 0 为手动调节屏幕亮度，1 为自动调节屏幕亮度 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### 示例：

##### brightness.setKeepScreenOn(OBJECT)

设置是否保持常亮状态

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| keepScreenOn | Boolean | 是 | 是否保持屏幕常亮 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### 示例：


---

## 应用配置_configuration.md

## 应用配置 configuration
================================================================================================================================================

## 接口声明

无需声明

## 导入模块

```
import configuration from '@system.configuration' 
// 或 
const configuration = require('@system.configuration')
```

## 接口定义

##### configuration.getLocale()

获取应用当前的语言环境。默认使用系统的语言环境，会因为设置或系统语言环境改变而发生变化

###### 参数：

无

###### 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| language | String | 语言 |
| countryOrRegion | String | 国家或地区 |

###### 示例：

```
const locale = configuration.getLocale()
console.log(locale.language)
```

接口声明

导入模块

接口定义

configuration.getLocale()")


---

## 弹窗_prompt.md

## 弹窗 prompt
=======================================================================================================

## 接口声明

```
{ "name": "system.prompt" }
```

## 导入模块

```
import prompt from '@system.prompt' 
// 或 
const prompt = require('@system.prompt')
```

## 接口定义

##### prompt.showToast(OBJECT)

显示 Toast 提示信息

###### 参数

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| message | String | 是 | 显示的文本信息 |
| duration | Number | 否 | 显示持续时间，单位ms，默认值1500，建议区间：1500-10000 |

###### 示例：

```
prompt.showToast({
  message: 'Message Info',
  duration: 2000
})
```

接口声明

导入模块

接口定义

prompt.showToast(OBJECT)")


---

## 振动_vibrator.md

## 接口声明

## 导入模块

## 接口定义

##### vibrator.vibrate(OBJECT)

触发振动

###### 参数：

| 参数 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| mode | String | 否 | 振动模式，"long"表示长振动，"short"表示短振动。默认为 long |

###### 示例：

##### vibrator.start(OBJECT)

开始振动

###### 参数：

| 参数 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| duration | Number | 是 | 振动持续时间(单位 ms)，必须为正整数 |
| interval | Number | 是 | 振动间隔时间(单位 ms)，必须为正整数 |
| count | Number | 是 | 振动次数，必须为正整数 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| id | Number | 唯一的 ID，标识振动任务 |

###### fail 返回值：

| 错误码 | 说明 |
| --- | --- |
| 205 | 任务已存在 |
| 202 | 参数错误 |

###### 示例：

##### vibrator.stop(Number)

停止振动

###### 参数：

| 类型 | 必填 | 说明 |
| --- | --- | --- |
| Number | 是 | 振动任务 ID |

###### 返回值：

| 类型 | 说明 |
| --- | --- |
| Boolean | true：成功；false：失败 |

###### 示例：

##### vibrator.getSystemDefaultMode()

获取系统默认振动模式

###### 参数：

无

###### 返回值：

| 类型 | 说明 |
| --- | --- |
| Number | 0：关闭振动；1：标准振动；2：加强振动 |

###### 示例：

## 支持明细

| 接口 | 已支持设备产品 | 不支持设备产品 |
| --- | --- | --- |
| vibrate | 小米 S1 Pro 运动健康手表、小米手环 8 Pro、小米手环 9 / 9 Pro、Redmi Watch 4、Xiaomi Watch H1、Xiaomi Watch S3、小米手环 10、Xiaomi Watch S4、REDMI Watch 5 | - |
| start | - | Xiaomi Watch S3、Xiaomi Watch S4、REDMI Watch 5、小米 S1 Pro 运动健康手表、小米手环 8 Pro、小米手环 9 / 9 Pro、小米手环 10、Redmi Watch 4、Xiaomi Watch H1 |
| stop | - | Xiaomi Watch S3、Xiaomi Watch S4、REDMI Watch 5、小米 S1 Pro 运动健康手表、小米手环 8 Pro、小米手环 9 / 9 Pro、小米手环 10、Redmi Watch 4、Xiaomi Watch H1 |
| getSystemDefaultMode | - | Xiaomi Watch S3、Xiaomi Watch S4、REDMI Watch 5、小米 S1 Pro 运动健康手表、小米手环 8 Pro、小米手环 9 / 9 Pro、小米手环 10、Redmi Watch 4、Xiaomi Watch H1 |


---

## 数据存储_storage.md

## 接口声明

## 导入模块

## 方法

##### storage.get(OBJECT)

读取存储内容

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| key | String | 是 | 索引 |
| default | String | 否 | 如果 key 不存在，返回 default。如果 default 未指定，返回长度为 0 的空字符串 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

key 对应的存储内容

###### 示例：

##### storage.set(OBJECT)

修改存储内容

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| key | String | 是 | 索引 |
| value | String | 否 | 新值。如果新值是长度为 0 的空字符串，会删除以 key 为索引的数据项 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### 示例：

##### storage.clear(OBJECT)

清空存储内容

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### 示例：

##### storage.delete(OBJECT)

删除存储内容

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| key | String | 是 | 索引 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### 示例：


---

## 数据文件.md

## 数据文件
=================================================================================================

提供本地数据存储和文件操作相关的能力。

*   数据存储
*   文件存储


---

## 数据请求_fetch.md

## 接口声明

## 导入模块

## 接口定义

##### fetch.fetch(OBJECT)

获取网络数据

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| url | String | 是 | 资源 url |
| data | String/Object/ArrayBuffer | 否 | 请求的参数，可以是字符串，或者是 js 对象、arraybuffer 对象。参考 `data与Content-Type关系` 部分 |
| header | Object | 否 | 请求的 header，会将其所有属性设置到请求的 header 部分。User-Agent 设置示例：{"Accept-Encoding": "gzip, deflate","Accept-Language": "zh-CN,en-US;q=0.8,en;q=0.6"} |
| method | String | 否 | 默认为 GET，可以是：OPTIONS，GET，HEAD，POST，PUT，DELETE，TRACE，CONNECT |
| responseType | String | 否 | 支持返回类型是 text，json，file，arraybuffer，默认会根据服务器返回 header 中的 Content-Type 确定返回类型，详见 `success返回值` |
| success | Function | 否 | 成功返回的回调函数 |
| fail | Function | 否 | 失败的回调函数，可能会因为权限失败 |
| complete | Function | 否 | 结束的回调函数（调用成功、失败都会执行） |

###### data 与 Content-Type 关系

| data | Content-Type | 说明 |
| --- | --- | --- |
| String | 不设置 | Content-Type 默认为 text/plain，data 值作为请求的 body |
| String | 任意 Type | data 值作为请求的 body |
| Object | 不设置 | Content-Type 默认为 application/x-www-form-urlencoded，data 按照 url 规则进行 encode 拼接作为请求的 body |
| Object | application/x-www-form-urlencoded | data 按照 url 规则进行 encode 拼接作为请求的 body |
| Object | application/x-www-form-urlencoded 之外的任意 type | - |
| ArrayBuffer | 不设置 | Content-Type 默认为 application/octet-stream，data 值作为请求的 body |
| ArrayBuffer | 任意 Type | data 值作为请求的 body |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| code | Integer | 服务器状态 code |
| data | String/Object /ArrayBuffer | 参考 `responseType与success中data关系` 部分 |
| headers | Object | 服务器 response 的所有 header |

###### responseType 与 success 中 data 关系：

| responseType | data | 说明 |
| --- | --- | --- |
| 无 | String | 服务器返回的 header 中 type 是 text/*或 application/json、application/javascript、application/xml，值是文本内容，否则是存储的临时文件的 uri，临时文件如果是图片或者视频内容，可以将图片设置到 image |
| text | String | 返回普通文本 |
| json | Object | 返回 js 对象 |
| file | String | 返回存储的临时文件的 uri |
| arraybuffer | ArrayBuffer | 返回 ArrayBuffer 对象 |

###### 示例：

## 支持明细

| 设备产品 | 说明 |
| --- | --- |
| 小米 S1 Pro 运动健康手表 | 支持 |
| 小米手环 8 Pro | 不支持 |
| 小米手环 9 / 9 Pro | 不支持 |
| Xiaomi Watch S3 | 支持 |
| Redmi Watch 4 | 不支持 |
| 小米腕部心电血压记录仪 | 不支持 |
| 小米手环 10 | 不支持 |
| Xiaomi Watch S4 | 支持 |
| REDMI Watch 5 | 支持 |


---

## 文件存储_file.md

## 接口声明

## 导入模块

## 接口定义

##### file.move(OBJECT)

将源文件移动到指定位置，接口中使用的 URI 描述请参考文件组织

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| srcUri | String | 是 | 源文件的 uri，不能是应用资源路径和 tmp 类型的 uri |
| dstUri | String | 是 | 目标文件的 uri，不能是应用资源路径和 tmp 类型的 uri |
| success | Function | 否 | 成功回调，返回目标文件的 uri |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |

###### 示例：

##### file.copy(OBJECT)

将源文件复制一份并存储到指定位置，接口中使用的 URI 描述请参考文件组织

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| srcUri | String | 是 | 源文件的 uri |
| dstUri | String | 是 | 目标文件的 uri，不能是应用资源路径和 tmp 类型的 uri |
| success | Function | 否 | 成功回调，返回目标文件的 uri |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |

###### 示例：

##### file.list(OBJECT)

获取指定目录下的文件列表，接口中使用的 URI 描述请参考文件组织

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 目录 uri |
| success | Function | 否 | 成功回调，返回{fileList:[{uri:'file1', lastModifiedTime:1234456, length:123456} ...]} |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| fileList | Array | 文件列表，每个文件的格式为{uri:'file1', lastModifiedTime:1234456, length:123456} |

###### 每个文件的元信息：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| length | Number | 文件大小，单位 B |
| lastModifiedTime | Number | 文件的保存是的时间戳，从 1970/01/01 00:00:00 GMT 到当前时间的毫秒数 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |

###### 示例：

##### file.get(OBJECT)

获取本地文件的文件信息，接口中使用的 URI 描述请参考文件组织

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 文件的 uri，不能是应用资源路径和 tmp 类型的 uri |
| recursive | Boolean | 否 | 是否递归获取子目录文件列表。默认 false |
| success | Function | 否 | 成功回调，返回{uri:'file1', length:123456, lastModifiedTime:1233456} |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| length | Number | 文件大小，单位 B。当 type = dir 时，返回0 |
| lastModifiedTime | Number | 文件的保存时的时间戳，从 1970/01/01 08:00:00 到当前时间的毫秒数 |
| type | String | 文件类型，dir：目录；file：文件 |
| subFiles | Array | 当 type = dir 时，返回目录中的文件列表，recursive 为 true 时，同时返回其子目录中的文件信息 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |

###### 示例：

##### file.delete(OBJECT)

删除本地存储的文件，接口中使用的 URI 描述请参考文件组织

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 需要删除的文件 uri，不能是应用资源路径和 tmp 类型的 uri |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |

###### 示例：

##### file.writeText(OBJECT)

写文本到文件

注意

当您使用文件写入接口时，请务必注意及时清理无用的文件，特别是在 IoT 设备内存较小的情况下，可以避免内存过载和应用崩溃的问题。

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 本地文件路径，不支持资源文件路径和 tmp 分区，如果文件不存在会创建文件 |
| text | String | 是 | 需要写入的字符串 |
| encoding | String | 否 | 编码格式，默认 UTF-8 |
| append | Boolean | 否 | 是否追加模式，默认 false |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |

###### 示例：

##### file.writeArrayBuffer(OBJECT)

写 Buffer 到文件

注意

当您使用文件写入接口时，请务必注意及时清理无用的文件，特别是在 IoT 设备内存较小的情况下，可以避免内存过载和应用崩溃的问题。

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 本地文件路径，不支持资源文件路径和 tmp 分区，如果文件不存在会创建文件 |
| buffer | Uint8Array | 是 | 需要写入的 Buffer |
| position | Number | 否 | 指向文件开始写入数据的位置的偏移量，默认 0 |
| append | Boolean | 否 | 是否追加模式，默认 false。当为 true 时，position 参数无效 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |

###### 示例：

##### file.readText(OBJECT)

从文件中读取文本

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 本地文件路径，支持应用资源路径，例如：'/Common/demo.txt' |
| encoding | String | 否 | 编码格式，默认 UTF-8 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| text | String | 读取的文本 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |
| 301 | 文件不存在 |

###### 示例：

##### file.readArrayBuffer(OBJECT)

从文件中读取 Buffer

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 本地文件路径，支持应用资源路径，例如：'/Common/demo.txt' |
| position | Number | 否 | 读取的起始位置，默认值为文件的起始位置 |
| length | Number | 否 | 读取的长度，不填写则读取到文件结尾 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| buffer | Uint8Array | 读取的文件内容 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |
| 301 | 文件不存在 |

###### 示例：

##### file.access(OBJECT)

判断文件或目录是否存在

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 目录或文件 uri |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |

###### 示例：

##### file.mkdir(OBJECT)

创建目录

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 目录的 uri，不能是应用资源路径和 tmp 类型的 uri |
| recursive | Boolean | 否 | 是否递归创建该目录的上级目录后再创建该目录。默认 false |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |

###### 示例：

##### file.rmdir(OBJECT)

删除目录

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 目录的 uri，不能是应用资源路径和 tmp 类型的 uri |
| recursive | Boolean | 否 | 是否递归删除子文件和子目录。默认 false |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### fail 返回错误代码：

| 错误码 | 说明 |
| --- | --- |
| 202 | 参数错误 |
| 300 | I/O 错误 |

###### 示例：


---

## 系统能力.md

## 系统能力

提供一些系统能力。

*   网络信息
*   振动
*   屏幕亮度
*   录音
*   地理位置
*   传感器
*   事件
*   电量信息
*   系统音量
*   解压缩


---

## 系统音量_volume.md

## 接口声明

## 导入模块

## 接口定义

##### volume.getMediaValue (OBJECT)

获取当前多媒体音量

###### 参数

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| value | Number | 系统媒体当前音量，0.0-1.0 之间 |

###### 示例

##### volume.setMediaValue (OBJECT)

设置当前多媒体音量

###### 参数

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| value | Number | 是 | 设置的音量，0.0-1.0 之间 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### fail 返回值：

支持通用错误码

###### 示例

## 事件

##### volume.onMediaValueChanged

多媒体音量发生变化事触发

###### 回调Object参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| value | Number | 是 | 系统媒体当前音量，范围：0.0-1.0 之间 |

###### 示例


---

## 网络信息_network.md

## 接口声明

## 导入模块

## 接口定义

##### network.getType(OBJECT)

获取网络类型

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调，可能是因为缺乏权限 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| type | String | 网络类型，可能的值为 2g，3g，4g，wifi，none，5g，bluetooth，others |

###### 示例：

##### network.subscribe(OBJECT)

监听网络类型变化。如果多次调用，仅最后一次调用生效

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| callback | Function | 否 | 每次网络发生变化，都会被回调 |
| fail | Function | 否 | 失败回调，可能是因为缺乏权限 |

###### callback 返回值：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| type | String | 网络类型，可能的值为 2g，3g，4g，wifi，none，5g，bluetooth，others。注：网络类型为 none 以外的值并不保证设备一定能访问到目标服务器，需要请求接口进行判断 |

###### 示例：

##### network.unsubscribe()

取消监听网络类型变化

###### 参数：

无

###### 示例：

## 支持明细

| 设备产品 | 说明 |
| --- | --- |
| 小米 S1 Pro 运动健康手表 | 支持 |
| 小米手环 8 Pro | 不支持 |
| 小米手环 9 / 9 Pro | 不支持 |
| Xiaomi Watch S3 | 支持 |
| Redmi Watch 4 | 不支持 |
| 小米腕部心电血压记录仪 | 不支持 |
| 小米手环 10 | 不支持 |
| Xiaomi Watch S4 | 支持 |
| REDMI Watch 5 | 支持 |


---

## 网络访问.md

## 网络访问
====================================================================================================

提供远程数据请求和本地蓝牙连接设备之间通信的能力。

*   数据请求
*   设备通信
*   下载
*   上传


---

## 设备信息_device.md

## 接口声明

## 导入模块

## 接口定义

##### device.getInfo(OBJECT)

获取设备信息

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| brand | string | 设备品牌 |
| manufacturer | string | 设备生产商 |
| model | string | 设备型号 |
| product | string | 设备代号 |
| osType | string | 操作系统名称 |
| osVersionName | string | 操作系统版本名称 |
| osVersionCode | number | 操作系统版本号 |
| platformVersionName | string | 运行平台版本名称 |
| platformVersionCode | number | 运行平台版本号 |
| language | string | 系统语言 |
| region | string | 系统地区 |
| APILevel2+ | number | 框架api版本 |
| screenWidth | number | 屏幕宽 |
| screenHeight | number | 屏幕高 |
| screenDensity3+ | number | 屏幕密度，即：设备像素比（device pixel ratio），是设备物理像素和逻辑像素（DP）的比值，其计算公式为：DPR = 设备 PPI / 160，PPI（pixels per inch）表示每英寸的像素数 |
| screenShape | string | 屏幕形状，可取值：rect 表示方形屏，circle 表示圆形屏，pill-shaped3+ 表示胶囊形屏 |
| deviceType2+ | string | 设备类型，可取值：watch、band、smartspeaker |

###### 示例：

##### device.getDeviceId(OBJECT)

获取设备唯一标识

###### 权限要求

获取设备信息

开发者需要在 manifest.json 里面配置权限：

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| deviceId | String | 设备唯一标识 |

###### 示例：

##### device.getSerial(OBJECT)

获取设备序列号

###### 权限要求

获取设备信息

开发者需要在 manifest.json 里面配置权限：

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| serial | String | 设备序列号 |

##### device.getTotalStorage(OBJECT)

获取存储空间的总大小

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| totalStorage | Number | 存储空间的总大小，单位是 Byte |

##### device.getAvailableStorage(OBJECT)

获取存储空间的可用大小

###### 参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| availableStorage | Number | 存储空间的可用大小，单位是 Byte |


---

## 设备通信_interconnect.md

## 接口声明

## 导入模块

## 接口定义

##### interconnect.instance()

获取连接对象，在 app 中以单例形式存在，后续的数据收发都是基于这个连接对象

###### 参数：

无

###### 返回值：

interconnect 的链接实例 connect 对象

###### 示例：

##### connect.getReadyState(OBJECT)

获取 App 连接状态

###### OBJECT参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |

###### success 返回值：

| 属性值 | 类型 | 说明 |
| --- | --- | --- |
| status | Number | 1：连接成功，2：连接断开 |

###### fail 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| data | String | 错误信息 |
| code | Number | 错误码 |

###### 错误码说明：

支持通用错误码

| 错误码 | 说明 |
| --- | --- |
| 1006 | 连接断开 |

###### 示例：

##### connect.diagnosis(OBJECT)

诊断手表应用和对端应用的连接情况，如果连接成功则返回ok，连接失败则返回失败原因。如果调用时正在连接则等待连接结束后再返回最终状态。

###### Obejct参数：

| 属性 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| timeout | Number | 否 | 等待诊断的超时时间，单位毫秒 默认值：10000ms |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |

###### success 返回值：

| 属性值 | 类型 | 说明 |
| --- | --- | --- |
| status | Number | 0: OK 链接成功 204：CONNECT_TIMEOUT 连接超时 1001：APP_UNINSTALLED 对端应用未安装 1000：OTHERS 其他链接错误 |

###### fail 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| data | String | 错误信息 |
| code | Number | 错误码 |

###### 错误码说明：

支持通用错误码

###### 示例：

##### connect.send(OBJECT)

发送数据到手机 App 端

###### Object参数：

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| data | Object | 是 | 发送的数据 |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |

###### success 返回值：

无

###### fail 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| data | String | 错误信息 |
| code | Number | 错误码 |

###### 错误码说明：

支持通用错误码

| 错误码 | 说明 |
| --- | --- |
| 204 | 链接超时 |
| 1006 | 连接断开 |

###### 示例：

## 事件

##### connect.onmessage

接收手机 App 端数据

###### 回调参数：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| data | String | 接收的数据 |

###### 示例：

##### connect.onopen

连接打开时的回调函数

###### 回调参数：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| isReconnected | Boolean | 是否是重新连接 |

###### 示例：

##### connect.onclose

连接关闭时的回调函数

###### 回调参数：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| code | Number | 链接关闭状态码 |
| data | String | 连接关闭返回的数据 |

###### 示例：

##### connect.onerror

连接出错时的回调函数

###### 回调参数：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| code | Number | 错误码，见错误码说明 |
| data | String | 错误信息 |

###### 错误码说明：

支持通用错误码

| 错误码 | 说明 |
| --- | --- |
| 1000 | 未知错误 |
| 1001 | 手机 APP 未安装 |
| 1006 | 连接断开 |

###### 示例：

## 开发注意事项

interconnect 通信前提要保证快应用和三方应用安卓端两者的包名及签名保持一致。

*   保证快应用 manifest.json 里 package 字段与 需要接入的三方app 安卓端包名一致。
*   快应用签名需要使用三方应用安卓端签名，可以从.jks中提取证书及私钥，方法如下：

1.   先将 jks 转换成 p12，执行以下命令，输入相应密码后，在同级目录下生成对应的 p12 格式文件。

1.   再将 p12 转 pem，执行以下命令，输入上一步设置的 p12 文件密码后，在同级目录下生成对应的 pem 格式文件。

1.   从 pem 格式文件中复制出私钥和证书：

 把-----BEGIN PRIVATE KEY-----到-----END PRIVATE KEY-----的内容复制到private.pem中。

 把-----BEGIN CERTIFICATE-----到-----END CERTIFICATE-----的内容复制到certificate.pem中。

    1.   上传 p12 文件并输入对应的密码；

    2.   点击“生成签名”按钮，等待签名生成成功弹窗出现；

    3.   点击“下载签名”按钮，下载 pem 格式的私钥和证书；

*   快应用需要将上述生成的私钥 private.pem 和证书 certificate.pem 放在快应用根目录 /sign/debug 和 /sign/release 下出包测试。

*   在真机测试的时候建议先输入包名uninstall老包再安装新包，可以观察桌面图标卸载的话会删除应用图标保证彻底替换。

参考附录

1.   小米穿戴第三方APP能力开放接口文档：点击下载(opens new window)
2.   interconnect开发测试demo：点击下载(opens new window)


---

## 通用规范.md

## 通用语法

框架提供各种接口来获取应用的基本信息或者调用系统能力，每个接口包含若干 api 来执行具体的任务。接口使用前需要进行接口声明、模块导入，然后才能调用该接口下定义的若干 api。

## 接口声明

在 manifest.json 文件的 features 字段下进行声明，例如：

## 导入模块

使用接口前，需要在代码里导入接口模块，例如：

## 接口 api 调用

接口提供的 api 的调用方式大概有以下几种：

*   同步 api
*   异步 api
*   订阅类 api

##### 同步 api 调用

如果 api 没有返回值，一般会定义成同步 api，直接调用即可，例如：

##### 异步 api 调用

如果 api 有返回值，一般会定义成异步 api 的形式，这类 api 除了普通参数，还有“success \ fail \ complete“这三个通用参数——分别是 api 执行“成功 \ 失败 \ 完成“后的回调方法，调用时可以传入这三个参数来获取 api 执行成功的返回值或进行执行失败 \ 完成后的处理，这三个通用参数的说明如下：

| 名称 | 方法参数 | 参数类型 | 参数值 | 说明 |
| --- | --- | --- | --- | --- |
| success | data | any | api 执行的返回值，详见接口使用文档 | api 执行成功后触发 |
| fail | data | any | api 执行错误信息内容，一般是字符串，也可能是其他类型，详见接口使用文档 | api 执行失败后触发 |
|  | code | number | api 执行错误码，详见通用错误码 |  |
| complete | - | - | - | api 执行完成后触发 |

代码示例：

##### 订阅 / 取消订阅 api

订阅类 api 不会立即返回结果，这类 api 需要开发者传入回调函数作为参数，该回调函数会在 api 完成时或者事件变化时被触发，可以执行多次。该通用回调函数参数说明如下：

| 名称 | 方法参数 | 参数类型 | 参数值 | 说明 |
| --- | --- | --- | --- | --- |
| success | data | any | api 执行的返回值，详见接口使用文档 | api 调用成功或事件变更时触发，可能会触发多次 |
| fail | data | any | 错误信息内容，一般是字符串，也可能是其他类型，详见接口使用文档 | api 执行失败时触发。一旦触发该回调函数，success不会再次被调用，接口调用结束 |
|  | code | number | api 执行错误码，详见通用错误码 |  |

代码示例：

## 通用错误码

所有接口的 api 在执行出现错误时，会返回统一定义的通用错误码或者 api 自己定义的特殊错误码。这里对通用错误码进行说明如下：

| code | 定义 |
| --- | --- |
| 200 | 系统通用错误，所有系统未知异常发生时抛出。比如框架申请内存空间失败等 |
| 201 | 用户拒绝 |
| 202 | 参数错误，调用时未按照 api 定义进行正确的传参 |
| 203 | 该功能不支持 |
| 204 | 请求超时 |
| 205 | 重复提交 |
| 207 | 用户拒绝并选择不再询问 |
| 300 | I/O 错误 |


---

## 音频_audio.md

## 接口声明

## 导入模块

## 方法

##### audio.play()

开始播放音频

###### 参数

无

###### 示例：

##### audio.pause()

暂停播放音频

###### 参数

无

###### 示例：

##### audio.stop()

停止音频播放，可以通过 play 重新播放音频

###### 参数

无

###### 示例：

##### audio.getPlayState(OBJECT)

获取当前播放状态数据

###### 参数

| 参数名 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| success | Function | 否 | 成功回调 |
| fail | Function | 否 | 失败回调 |
| complete | Function | 否 | 执行结束后的回调 |

###### success 返回值：

| 参数值 | 类型 | 说明 |
| --- | --- | --- |
| state | String | 播放状态,分别为'play'，'pause'，'stop' |
| src | String | 当前播放的音频媒体 uri，停止时返回空字符串 |
| currentTime | Number | 当前音频的当前进度，单位秒，停止时返回-1 |
| percent | Number | 当前播放进度百分比，范围0-100 |
| autoplay | Boolen | 当前音频是否在自动播放 |
| loop | Boolen | 当前音频是否在循环播放 |
| volume | Number | 当前音频的音量，默认当前系统媒体音量，音量变化范围[0.0,1.0] |
| muted | Boolen | 当前音频是否在静音播放 |
| duration | Number | 音频的播放时长，单位秒，未知返回 NaN |

###### 示例：

## 属性

| 名称 | 参数类型 | 是否可读 | 是否可写 | 必填 | 描述 |
| --- | --- | --- | --- | --- | --- |
| src | String | 是 | 是 | 是 | 播放的音频媒体 uri |
| currentTime | Number | 是 | 是 | 否 | 音频的当前进度，单位秒，对值设置可以调整播放进度 |
| duration | Number | 是 | 否 | 否 | 音频的播放时长，单位秒，未知返回 NaN |
| autoplay | Boolean | 是 | 是 | 否 | 音频是否自动播放，默认 false |
| loop | Boolean | 是 | 是 | 否 | 音频是否循环播放，默认 false |
| volume | Number | 是 | 是 | 否 | 音频的音量，默认当前系统媒体音量，音量变化范围[0.0,1.0] |
| muted | Boolean | 是 | 是 | 否 | 音频是否静音，默认 false |
| streamType | String | 是 | 否 | 否 | 使用音频的类型，可能的值有 music、voicecall，值为 music 时使用扬声器播放，voicecall 时使用听筒播放（手表、手环设备不支持此配置），默认为 music |
| meta | Object<{title: string, artist: string, album: string}> | 否 | 是 | 否 | 音频元数据信息，包括歌名、歌手、专辑名 |

###### 示例：

## 事件

| 名称 | 描述 |
| --- | --- |
| play | 在调用 play 方法后或者 autoplay 为 true 时的回调事件。被动触发场景举例：1. 蓝牙耳机控制播放音频 |
| pause | 在调用 pause 方法后的回调事件。被动触发场景举例：1. 音频焦点被抢占，例如：播放音频时收到来电；2. 蓝牙耳机控制暂停音频 |
| stop | 在调用 stop 方法后的回调事件。被动触发场景举例：1. 正在打电话时播放音频 |
| loadeddata | 第一次获取到音频数据的回调事件 |
| ended | 播放结束时的回调事件 |
| durationchange | 播放时长变化时的回调事件 |
| error | 播放发生错误时的回调事件 |

###### 示例：


---

## 页面路由_router.md

## 接口声明

无需声明

## 导入模块

## 接口定义

##### router.push(OBJECT)

跳转到应用内的某个页面

###### 参数：

| 参数 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 要跳转到的 uri，可以是下面的格式： 1、包含 schema 的完整 uri； 2、以‘/’开头的应用内页面的路径；例：/about 3、以非‘/’开头的应用内页面的名称；例：About 4、特殊的，如果 uri 的值是"/"，则跳转到 path 为"/"的页，没有则跳转到首页 支持包含 schema 的完整 uri。对于带有 schema 的 uri，处理流程如下： 如果 schema 是 hap （参见 hap 链接），会跳转到 hap 链接所支持的类型 |
| params | Object | 否 | 跳转时需要传递的数据，参数可以在目标页面中通过`this.param1`的方式使用，param1 为 json 中的参数名，param1 对应的值会统一转换为 String 类型。使用`this.param1`变量时，需要在目标页面中在 `public`（应用外传参）或 `protected` (应用内传参)下定义 key 名相同的属性 |

###### params参数：

| 参数 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| ___PARAM_LAUNCH_FLAG___ | String | 否 | JS 应用启动参数，目前仅支持"clearTask"，在启动目标页面时会清除除此页面外的其他页面。详见页面启动模式 |

###### 示例：

*   应用内切换页面

    *   path 切换
    *   name 切换
    *   切换页面并清除其他页面

##### router.replace(OBJECT)

用应用内的某个页面替换当前页面，并销毁被替换的页面

###### 参数：

| 参数 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| uri | String | 是 | 要跳转到的 uri，可以是下面的格式： 1. 以"/"开头的应用内页面的路径；例：/about 2. 以非"/"开头的应用内页面的名称；例：About 3. 特殊的，如果 uri 的值是"/"，则跳转到 path 为"/"的页，没有则跳转到首页 |
| params | Object | 否 | 跳转时需要传递的数据，参数可以在目标页面中通过`this.param1`的方式使用，param1 为 json 中的参数名，param1 对应的值会统一转换为 String 类型。使用`this.param1`变量时，需要在目标页面中在 `public`（应用外传参）或 `protected` (应用内传参)下定义 key 名相同的属性 |

###### 示例：

##### router.back(OBJECT)

返回指定页面

###### 参数：

| 参数 | 类型 | 必填 | 说明 |
| --- | --- | --- | --- |
| path | String | 否 | 返回目标页面的路径，可以是以下几种取值： 1. 不传该参数，返回上一页面 2. 以"/"开头的应用内已打开页面的路径；例：/about 3. 特殊的，如果 path 的值是"/"，则跳转到页面名称为"/"的页，没有则跳转到首页 注意点： 1. path 需要是以"/"开头的当前应用已经打开的页面路径，否则均视为无效参数，返回上一页面 2. 若根据 path 未匹配到已经打开的页面，返回上一页面 3. 若根据 path 参数匹配到多个页面，返回至最后打开的页面 |

###### 示例：

##### router.clear()

清空所有历史页面记录，仅保留当前页面

###### 参数：

无

###### 示例：

##### router.getLength()

获取当前页面栈的页面数量

###### 返回值:

| 类型 | 说明 |
| --- | --- |
| Number | 页面数量 |

###### 示例：

##### router.getState()

获取当前页面状态

###### 返回参数：

| 参数名 | 类型 | 说明 |
| --- | --- | --- |
| index | Number | 当前页面在页面栈中的位置 |
| name | String | 当前页面的名称 |
| path | String | 当前页面的路径 |

###### 示例：

##### router.getPages()

获取当前页面栈列表

###### 返回值：

| 类型 | 说明 |
| --- | --- |
| Array | 页面栈列表。数组每一项都为 Object 类型 |

数组每一项构成：

| 字段 | 类型 | 说明 |
| --- | --- | --- |
| name | String | 页面的名称 |
| path | String | 页面的路径 |

###### 示例：

